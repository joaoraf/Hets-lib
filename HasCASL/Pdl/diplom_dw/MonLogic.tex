%
\begin{isabellebody}%
\def\isabellecontext{MonLogic}%
%
\isamarkupheader{Introducing Propositional Connectives%
}
\isamarkuptrue%
\isacommand{theory}\ MonLogic\ {\isacharequal}\ MonProp{\isacharcolon}\isamarkupfalse%
%
\label{sec:monlogic-thy}
%
\isamarkupsubsection{Propositional Connectives%
}
\isamarkuptrue%
%
\begin{isamarkuptext}%
As usual in intuitionistic logics, we introduce conjunction,
  disjunction and implication independently of each other.
  \label{isa:logical-const}%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{consts}\isanewline
\ {\isachardoublequote}Valid{\isachardoublequote}\ \ \ \ \ \ \ {\isacharcolon}{\isacharcolon}\ {\isachardoublequote}bool\ D\ {\isasymRightarrow}\ bool{\isachardoublequote}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isachardoublequote}{\isacharparenleft}{\isasymturnstile}\ {\isacharunderscore}{\isacharparenright}{\isachardoublequote}\ {\isadigit{1}}{\isadigit{5}}{\isacharparenright}\isanewline
\ {\isachardoublequote}{\isasymand}\isactrlsub D{\isachardoublequote}\ \ \ \ \ \ \ \ \ {\isacharcolon}{\isacharcolon}\ {\isachardoublequote}{\isacharbrackleft}bool\ D{\isacharcomma}\ bool\ D{\isacharbrackright}\ {\isasymRightarrow}\ bool\ D{\isachardoublequote}\ \ \ \ \ {\isacharparenleft}\isakeyword{infixr}\ {\isadigit{3}}{\isadigit{5}}{\isacharparenright}\isanewline
\ {\isachardoublequote}{\isasymor}\isactrlsub D{\isachardoublequote}\ \ \ \ \ \ \ \ \ {\isacharcolon}{\isacharcolon}\ {\isachardoublequote}{\isacharbrackleft}bool\ D{\isacharcomma}\ bool\ D{\isacharbrackright}\ {\isasymRightarrow}\ bool\ D{\isachardoublequote}\ \ \ \ \ {\isacharparenleft}\isakeyword{infixr}\ {\isadigit{3}}{\isadigit{0}}{\isacharparenright}\isanewline
\ {\isachardoublequote}{\isasymlongrightarrow}\isactrlsub D{\isachardoublequote}\ \ \ \ \ \ \ \ {\isacharcolon}{\isacharcolon}\ {\isachardoublequote}{\isacharbrackleft}bool\ D{\isacharcomma}\ bool\ D{\isacharbrackright}\ {\isasymRightarrow}\ bool\ D{\isachardoublequote}\ \ \ \ {\isacharparenleft}\isakeyword{infixr}\ {\isadigit{2}}{\isadigit{5}}{\isacharparenright}\isamarkupfalse%
%
\begin{isamarkuptext}%
According with the definition in \cite{SchroederMossakowski:PDL}, the connectives
  are simply lifted from HOL, and validity amounts to being
  equal to a program always returning \isa{True}.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{defs}\isanewline
\ \ Valid{\isacharunderscore}def{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymequiv}\ {\isasymDown}\ P\ {\isacharequal}\ do\ {\isacharbraceleft}x{\isasymleftarrow}{\isacharparenleft}{\isasymDown}\ P{\isacharparenright}{\isacharsemicolon}\ ret\ True{\isacharbraceright}{\isachardoublequote}\isanewline
\ \ conjD{\isacharunderscore}def{\isacharcolon}\ {\isachardoublequote}P\ {\isasymand}\isactrlsub D\ Q\ {\isasymequiv}\ {\isasymUp}\ {\isacharparenleft}liftM{\isadigit{2}}\ {\isacharparenleft}op\ {\isasymand}{\isacharparenright}\ {\isacharparenleft}{\isasymDown}\ P{\isacharparenright}\ {\isacharparenleft}{\isasymDown}\ Q{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ disjD{\isacharunderscore}def{\isacharcolon}\ {\isachardoublequote}P\ {\isasymor}\isactrlsub D\ Q\ {\isasymequiv}\ {\isasymUp}\ {\isacharparenleft}liftM{\isadigit{2}}\ {\isacharparenleft}op\ {\isasymor}{\isacharparenright}\ {\isacharparenleft}{\isasymDown}\ P{\isacharparenright}\ {\isacharparenleft}{\isasymDown}\ Q{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ impD{\isacharunderscore}def{\isacharcolon}\ \ {\isachardoublequote}P\ {\isasymlongrightarrow}\isactrlsub D\ Q\ {\isasymequiv}\ {\isasymUp}\ {\isacharparenleft}liftM{\isadigit{2}}\ {\isacharparenleft}op\ {\isasymlongrightarrow}{\isacharparenright}\ {\isacharparenleft}{\isasymDown}\ P{\isacharparenright}\ {\isacharparenleft}{\isasymDown}\ Q{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\isanewline
\isanewline
\isamarkupfalse%
\isacommand{constdefs}\isanewline
\ iffD\ \ \ \ \ \ \ \ {\isacharcolon}{\isacharcolon}\ {\isachardoublequote}{\isacharbrackleft}bool\ D{\isacharcomma}\ bool\ D{\isacharbrackright}\ {\isasymRightarrow}\ bool\ D{\isachardoublequote}\ \ \ {\isacharparenleft}\isakeyword{infixr}\ {\isachardoublequote}{\isasymlongleftrightarrow}\isactrlsub D{\isachardoublequote}\ {\isadigit{2}}{\isadigit{0}}{\isacharparenright}\isanewline
\ {\isachardoublequote}P\ {\isasymlongleftrightarrow}\isactrlsub D\ Q\ {\isasymequiv}\ {\isacharparenleft}P\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isacharparenright}\ {\isasymand}\isactrlsub D\ {\isacharparenleft}Q\ {\isasymlongrightarrow}\isactrlsub D\ P{\isacharparenright}{\isachardoublequote}\isanewline
\ NotD\ \ \ \ \ \ \ \ {\isacharcolon}{\isacharcolon}\ {\isachardoublequote}bool\ D\ {\isasymRightarrow}\ bool\ D{\isachardoublequote}\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isachardoublequote}{\isasymnot}\isactrlsub D\ {\isacharunderscore}{\isachardoublequote}\ {\isacharbrackleft}{\isadigit{4}}{\isadigit{0}}{\isacharbrackright}\ {\isadigit{4}}{\isadigit{0}}{\isacharparenright}\isanewline
\ \ {\isachardoublequote}{\isasymnot}\isactrlsub D\ P\ {\isasymequiv}\ P\ {\isasymlongrightarrow}\isactrlsub D\ Ret\ False{\isachardoublequote}\isamarkupfalse%
%
\begin{isamarkuptext}%
Because of discardability, the definition of \isa{Valid}, which 
  was simply taken over from the definition of global validity of terms of type
  \isa{bool\ T}, can be simplified.
  \label{isa:valid-simp}%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\ Valid{\isacharunderscore}simp{\isacharcolon}\ {\isachardoublequote}{\isacharparenleft}{\isasymturnstile}\ p{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymDown}\ p\ {\isacharequal}\ ret\ True{\isacharparenright}{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ vp{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ p{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{show}\ {\isachardoublequote}{\isasymDown}\ p\ {\isacharequal}\ ret\ True{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{from}\ vp\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ p\ {\isacharequal}\ do\ {\isacharbraceleft}{\isasymDown}\ p{\isacharsemicolon}\ ret\ True{\isacharbraceright}{\isachardoublequote}\isanewline
\ \ \ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ Valid{\isacharunderscore}def\ seq{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ ret\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ dis{\isacharunderscore}left{\isacharcomma}\ rule\ dis{\isacharunderscore}Rep{\isacharunderscore}Dsef{\isacharparenright}\ \ \isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{finally}\ \isamarkupfalse%
\isacommand{show}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{{\isachardot}}\isanewline
\ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\isamarkupfalse%
\isacommand{next}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ {\isachardoublequote}{\isasymDown}\ p\ {\isacharequal}\ ret\ True{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{hence}\ {\isachardoublequote}{\isasymDown}\ p\ {\isacharequal}\ do\ {\isacharbraceleft}x{\isasymleftarrow}{\isasymDown}\ p{\isacharsemicolon}\ ret\ True{\isacharbraceright}{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ simp\isanewline
\ \ \isamarkupfalse%
\isacommand{thus}\ {\isachardoublequote}{\isasymturnstile}\ p{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ Valid{\isacharunderscore}def{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ Valid{\isacharunderscore}simpD{\isacharcolon}\ {\isachardoublequote}{\isacharparenleft}{\isasymturnstile}\ P{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}P\ {\isacharequal}\ Ret\ True{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ Valid{\isacharunderscore}simp\ Ret{\isacharunderscore}ret\ Ret{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}induct{\isacharunderscore}tac\ P\ rule{\isacharcolon}\ \ Abs{\isacharunderscore}Dsef{\isacharunderscore}induct{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ Dsef{\isacharunderscore}def\ Abs{\isacharunderscore}Dsef{\isacharunderscore}inverse{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}rule\ Abs{\isacharunderscore}Dsef{\isacharunderscore}inject{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp{\isacharunderscore}all\ add{\isacharcolon}\ Dsef{\isacharunderscore}def{\isacharparenright}\isamarkupfalse%
%
\begin{isamarkuptext}%
There is a notion of homomorphism associated with lifted operations. The formulation
  does not really make clear what is intended, but the subsequent lemmas should
  illuminate the idea.
  \label{isa:lift-ret-hom}%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{theorem}\ lift{\isacharunderscore}Ret{\isacharunderscore}hom{\isacharcolon}\ \ {\isachardoublequote}{\isacharparenleft}{\isasymUp}\ {\isacharparenleft}liftM{\isadigit{2}}\ f\ {\isacharparenleft}{\isasymDown}\ {\isacharparenleft}Ret\ a{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}{\isasymDown}\ {\isacharparenleft}Ret\ b{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharequal}\ Ret\ {\isacharparenleft}f\ a\ b{\isacharparenright}{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymUp}\ {\isacharparenleft}liftM{\isadigit{2}}\ f\ {\isacharparenleft}{\isasymDown}\ {\isacharparenleft}Ret\ a{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}{\isasymDown}\ {\isacharparenleft}Ret\ b{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ {\isacharequal}\ {\isasymUp}\ {\isacharparenleft}do\ {\isacharbraceleft}x{\isasymleftarrow}{\isacharparenleft}{\isasymDown}\ {\isacharparenleft}Ret\ a{\isacharparenright}{\isacharparenright}{\isacharsemicolon}\ y{\isasymleftarrow}{\isacharparenleft}{\isasymDown}\ {\isacharparenleft}Ret\ b{\isacharparenright}{\isacharparenright}{\isacharsemicolon}\ ret\ {\isacharparenleft}f\ x\ y{\isacharparenright}{\isacharbraceright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ liftM{\isadigit{2}}{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ {\isasymUp}\ {\isacharparenleft}do\ {\isacharbraceleft}x{\isasymleftarrow}{\isacharparenleft}{\isasymDown}\ {\isacharparenleft}{\isasymUp}\ {\isacharparenleft}ret\ a{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharsemicolon}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y{\isasymleftarrow}{\isacharparenleft}{\isasymDown}\ {\isacharparenleft}{\isasymUp}\ {\isacharparenleft}ret\ b{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharsemicolon}\ ret\ {\isacharparenleft}f\ x\ y{\isacharparenright}{\isacharbraceright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Ret{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ {\isasymUp}\ {\isacharparenleft}do\ {\isacharbraceleft}x{\isasymleftarrow}ret\ a{\isacharsemicolon}\ y{\isasymleftarrow}ret\ b{\isacharsemicolon}\ ret{\isacharparenleft}f\ x\ y{\isacharparenright}{\isacharbraceright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Dsef{\isacharunderscore}def\ Abs{\isacharunderscore}Dsef{\isacharunderscore}inverse{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ {\isasymUp}\ {\isacharparenleft}ret\ {\isacharparenleft}f\ a\ b{\isacharparenright}{\isacharparenright}{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ simp\isanewline
\ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ Ret\ {\isacharparenleft}f\ a\ b{\isacharparenright}{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ Ret{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{finally}\ \isamarkupfalse%
\isacommand{show}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{{\isachardot}}\isanewline
\isamarkupfalse%
\isacommand{qed}\isanewline
\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ conjD{\isacharunderscore}Ret{\isacharunderscore}hom{\isacharcolon}\ {\isachardoublequote}Ret\ {\isacharparenleft}a{\isasymand}b{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isacharparenleft}Ret\ a{\isacharparenright}\ {\isasymand}\isactrlsub D\ {\isacharparenleft}Ret\ b{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ lift{\isacharunderscore}Ret{\isacharunderscore}hom\ conjD{\isacharunderscore}def{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{lemma}\ disjD{\isacharunderscore}Ret{\isacharunderscore}hom{\isacharcolon}\ {\isachardoublequote}Ret\ {\isacharparenleft}a{\isasymor}b{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isacharparenleft}Ret\ a{\isacharparenright}\ {\isasymor}\isactrlsub D\ {\isacharparenleft}Ret\ b{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ lift{\isacharunderscore}Ret{\isacharunderscore}hom\ disjD{\isacharunderscore}def{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{lemma}\ impD{\isacharunderscore}Ret{\isacharunderscore}hom{\isacharcolon}\ {\isachardoublequote}Ret\ {\isacharparenleft}a{\isasymlongrightarrow}b{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isacharparenleft}Ret\ a{\isacharparenright}\ {\isasymlongrightarrow}\isactrlsub D\ {\isacharparenleft}Ret\ b{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ lift{\isacharunderscore}Ret{\isacharunderscore}hom\ impD{\isacharunderscore}def{\isacharparenright}\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ NotD{\isacharunderscore}Ret{\isacharunderscore}hom{\isacharcolon}\ {\isachardoublequote}Ret\ {\isacharparenleft}{\isasymnot}\ P{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ {\isacharparenleft}Ret\ P{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{by}{\isacharparenleft}simp\ add{\isacharcolon}\ NotD{\isacharunderscore}def\ impD{\isacharunderscore}Ret{\isacharunderscore}hom{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharparenright}\isamarkupfalse%
%
\begin{isamarkuptext}%
If a formula depending on variable \isa{x} is valid for all \isa{x}, then we
  may also `substitute' it by a \isa{dsef} term.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\ dsef{\isacharunderscore}form{\isacharcolon}\ {\isachardoublequote}\ {\isasymforall}x{\isachardot}\ {\isasymturnstile}\ P\ x\ {\isasymLongrightarrow}\ {\isasymforall}b{\isachardot}\ {\isasymturnstile}\ {\isasymUp}\ {\isacharparenleft}do\ {\isacharbraceleft}a{\isasymleftarrow}{\isasymDown}\ b{\isacharsemicolon}\ {\isasymDown}\ {\isacharparenleft}P\ a{\isacharparenright}{\isacharbraceright}{\isacharparenright}{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\isanewline
\ \ \isamarkupfalse%
\isacommand{fix}\ b\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ a{\isadigit{1}}{\isacharcolon}\ {\isachardoublequote}\ {\isasymforall}x{\isachardot}\ {\isasymturnstile}\ P\ x{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{hence}\ {\isachardoublequote}{\isasymDown}\ {\isacharparenleft}{\isasymUp}\ {\isacharparenleft}do\ {\isacharbraceleft}a{\isasymleftarrow}{\isasymDown}\ {\isacharparenleft}b{\isacharcolon}{\isacharcolon}{\isacharprime}a\ D{\isacharparenright}{\isacharsemicolon}\ {\isasymDown}\ {\isacharparenleft}P\ a{\isacharparenright}{\isacharbraceright}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ {\isasymDown}\ {\isacharparenleft}{\isasymUp}\ {\isacharparenleft}do\ {\isacharbraceleft}a{\isasymleftarrow}{\isasymDown}\ {\isacharparenleft}b{\isacharcolon}{\isacharcolon}{\isacharprime}a\ D{\isacharparenright}{\isacharsemicolon}\ ret\ True{\isacharbraceright}{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Valid{\isacharunderscore}simp{\isacharparenright}\ \isanewline
\ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ do\ {\isacharbraceleft}a{\isasymleftarrow}{\isasymDown}\ b{\isacharsemicolon}\ ret\ True{\isacharbraceright}{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharparenleft}rule\ Abs{\isacharunderscore}Dsef{\isacharunderscore}inverse{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}dsef\ {\isacharparenleft}do\ {\isacharbraceleft}a{\isasymleftarrow}{\isasymDown}\ b{\isacharsemicolon}\ ret\ True{\isacharbraceright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ dsef{\isacharunderscore}ret\ dsef{\isacharunderscore}Rep{\isacharunderscore}Dsef\ dsef{\isacharunderscore}seq{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{thus}\ {\isachardoublequote}do\ {\isacharbraceleft}a{\isasymleftarrow}{\isasymDown}\ b{\isacharsemicolon}\ ret\ True{\isacharbraceright}\ {\isasymin}\ Dsef{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Dsef{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ ret\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ dis{\isacharunderscore}left{\isadigit{2}}\ dsef{\isacharunderscore}dis{\isacharbrackleft}OF\ dsef{\isacharunderscore}Rep{\isacharunderscore}Dsef{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{finally}\ \isamarkupfalse%
\isacommand{show}\ {\isachardoublequote}{\isasymturnstile}\ {\isasymUp}\ {\isacharparenleft}do\ {\isacharbraceleft}a{\isasymleftarrow}{\isasymDown}\ {\isacharparenleft}b{\isacharcolon}{\isacharcolon}{\isacharprime}a\ D{\isacharparenright}{\isacharsemicolon}\ {\isasymDown}\ {\isacharparenleft}P\ a{\isacharparenright}{\isacharbraceright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Valid{\isacharunderscore}simp{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isamarkupfalse%
%
\begin{isamarkuptext}%
Every true formula may be injected into \isa{bool\ D} by \isa{Ret} to 
  yield a valid formula of dynamic logic. And the converse also holds!
  \label{isa:valid-ret}%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{theorem}\ Valid{\isacharunderscore}Ret\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequote}{\isacharparenleft}{\isasymturnstile}\ Ret\ P{\isacharparenright}\ {\isacharequal}\ P{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ \isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ p{\isacharcolon}\ {\isachardoublequote}P{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ {\isacharparenleft}Ret\ P{\isacharparenright}\ {\isacharequal}\ do\ {\isacharbraceleft}x{\isasymleftarrow}{\isasymDown}\ {\isacharparenleft}Ret\ P{\isacharparenright}{\isacharsemicolon}\ ret\ True{\isacharbraceright}{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}dsef\ {\isacharparenleft}{\isasymDown}\ {\isacharparenleft}Ret\ P{\isacharparenright}{\isacharparenright}{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ dsef{\isacharunderscore}Rep{\isacharunderscore}Dsef{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{hence}\ ds{\isacharcolon}\ {\isachardoublequote}dis\ {\isacharparenleft}{\isasymDown}\ {\isacharparenleft}Ret\ P{\isacharparenright}{\isacharparenright}{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ dsef{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ {\isacharparenleft}Ret\ P{\isacharparenright}\ {\isacharequal}\ ret\ P{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ Ret{\isacharunderscore}ret{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{from}\ p\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ ret\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ simp\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{from}\ ds\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ do\ {\isacharbraceleft}{\isasymDown}\ {\isacharparenleft}Ret\ P{\isacharparenright}{\isacharsemicolon}\ ret\ True{\isacharbraceright}{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ dis{\isacharunderscore}left{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{finally}\ \isamarkupfalse%
\isacommand{show}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ seq{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\ \ \isamarkupfalse%
\isacommand{thus}\ {\isachardoublequote}{\isasymturnstile}\ Ret\ P{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ Valid{\isacharunderscore}def{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{next}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ rp{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ Ret\ P{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{hence}\ {\isachardoublequote}{\isasymDown}\ {\isacharparenleft}Ret\ P{\isacharparenright}\ {\isacharequal}\ ret\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ iffD{\isadigit{1}}{\isacharbrackleft}OF\ Valid{\isacharunderscore}simp{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{hence}\ {\isachardoublequote}ret\ P\ {\isacharequal}\ ret\ True{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Ret{\isacharunderscore}def\ Dsef{\isacharunderscore}def\ Abs{\isacharunderscore}Dsef{\isacharunderscore}inverse{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{hence}\ {\isachardoublequote}P\ {\isacharequal}\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ ret{\isacharunderscore}inject{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{thus}\ {\isachardoublequote}P{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ rules\isanewline
\isamarkupfalse%
\isacommand{qed}\isamarkupfalse%
%
\begin{isamarkuptext}%
A bit more tedious, but conversely to \isa{Valid{\isacharunderscore}simp} it is also true
  that every valid formula that is a negation equals \isa{ret\ False}.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\ Valid{\isacharunderscore}not{\isacharunderscore}eq{\isacharunderscore}ret{\isacharunderscore}False{\isacharcolon}\ {\isachardoublequote}{\isacharparenleft}{\isasymturnstile}\ {\isasymnot}\isactrlsub D\ b{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymDown}\ b\ {\isacharequal}\ ret\ False{\isacharparenright}{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ {\isachardoublequote}{\isasymturnstile}\ {\isasymnot}\isactrlsub D\ b{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{hence}\ nt{\isacharcolon}\ {\isachardoublequote}{\isasymDown}\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ b{\isacharparenright}\ {\isacharequal}\ ret\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Valid{\isacharunderscore}simp{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{show}\ {\isachardoublequote}{\isasymDown}\ b\ {\isacharequal}\ ret\ False{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}dsef\ {\isacharparenleft}do\ {\isacharbraceleft}x{\isasymleftarrow}{\isasymDown}\ b{\isacharsemicolon}\ ret\ {\isacharparenleft}{\isasymnot}\ x{\isacharparenright}{\isacharbraceright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ weak{\isacharunderscore}dsef{\isacharunderscore}seq{\isacharcomma}\ rule\ dsef{\isacharunderscore}Rep{\isacharunderscore}Dsef{\isacharparenright}\ \isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{hence}\ bnnb{\isacharcolon}\ {\isachardoublequote}b\ {\isacharequal}\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ b{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ NotD{\isacharunderscore}def\ impD{\isacharunderscore}def\ liftM{\isadigit{2}}{\isacharunderscore}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ret{\isacharunderscore}ret\ Abs{\isacharunderscore}Dsef{\isacharunderscore}inverse\ Dsef{\isacharunderscore}def\ mon{\isacharunderscore}ctr\ Rep{\isacharunderscore}Dsef{\isacharunderscore}inverse{\isacharparenright}\ \isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{from}\ nt\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymUp}\ {\isacharparenleft}{\isasymDown}\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ b{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ Ret\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Ret{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{hence}\ {\isachardoublequote}{\isacharparenleft}{\isasymnot}\isactrlsub D\ b{\isacharparenright}\ {\isacharequal}\ Ret\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ Rep{\isacharunderscore}Dsef{\isacharunderscore}inverse{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{hence}\ {\isachardoublequote}{\isacharparenleft}{\isasymnot}\isactrlsub D\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ b{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ {\isacharparenleft}Ret\ True{\isacharparenright}{\isacharparenright}{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ simp\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{with}\ bnnb\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}b\ {\isacharequal}\ Ret\ {\isacharparenleft}{\isasymnot}\ True{\isacharparenright}{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ NotD{\isacharunderscore}Ret{\isacharunderscore}hom{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{thus}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Ret{\isacharunderscore}ret{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\isamarkupfalse%
\isacommand{next}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ {\isachardoublequote}{\isasymDown}\ b\ {\isacharequal}\ ret\ False{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{hence}\ {\isachardoublequote}{\isasymUp}\ {\isacharparenleft}{\isasymDown}\ b{\isacharparenright}\ {\isacharequal}\ {\isasymUp}\ {\isacharparenleft}ret\ False{\isacharparenright}{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ simp\isanewline
\ \ \isamarkupfalse%
\isacommand{hence}\ bf{\isacharcolon}\ {\isachardoublequote}b\ {\isacharequal}\ Ret\ False{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Rep{\isacharunderscore}Dsef{\isacharunderscore}inverse\ Ret{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ b{\isacharparenright}\ {\isacharequal}\ ret\ True{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{from}\ bf\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ b{\isacharparenright}\ {\isacharequal}\ {\isasymDown}\ {\isacharparenleft}Ret\ False\ {\isasymlongrightarrow}\isactrlsub D\ Ret\ False{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ NotD{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ {\isasymDown}\ {\isacharparenleft}Ret\ True{\isacharparenright}{\isachardoublequote}\ \isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \ \ \ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isacharparenleft}Ret\ False\ {\isasymlongrightarrow}\isactrlsub D\ Ret\ False{\isacharparenright}\ {\isacharequal}\ Ret\ {\isacharparenleft}False\ {\isasymlongrightarrow}\ False{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \ \ \ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ impD{\isacharunderscore}Ret{\isacharunderscore}hom{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isamarkupfalse%
\isacommand{thus}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{by}\ simp\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ ret\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ Ret{\isacharunderscore}ret{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{finally}\ \isamarkupfalse%
\isacommand{show}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{{\isachardot}}\isanewline
\ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\ \ \isamarkupfalse%
\isacommand{thus}\ {\isachardoublequote}{\isasymturnstile}\ {\isasymnot}\isactrlsub D\ b{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ Valid{\isacharunderscore}simp{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isamarkupfalse%
%
\begin{isamarkuptext}%
Lemmas \isa{Valid{\isacharunderscore}simp}, \isa{Valid{\isacharunderscore}not{\isacharunderscore}eq{\isacharunderscore}ret{\isacharunderscore}False} 
  and \isa{Valid{\isacharunderscore}Ret} show that, since the classical type \isa{bool} 
  is taken as the carrier of truth values, the whole calculus is classical.%
\end{isamarkuptext}%
\isamarkuptrue%
%
\isamarkupsubsection{Setting up the Simplifier for Propositional Reasoning%
}
\isamarkuptrue%
%
\begin{isamarkuptext}%
Since natural deduction rules don't get us far in the calculus of global
  validity judgments (in particular, we do not have an analogon for
  the implication introduction rule), we algebraize it and perform
  proofs by term manipulation.
 
  All these axioms are in fact provable; it is just the shortage of time that
  forces us to impose them directly.  
  \label{isa:simp-pdl-taut}%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{constdefs}\isanewline
\ \ xorD\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequote}{\isacharbrackleft}bool\ D{\isacharcomma}\ bool\ D{\isacharbrackright}\ {\isasymRightarrow}\ bool\ D{\isachardoublequote}\ \ \ \ \ \ {\isacharparenleft}\isakeyword{infixr}\ {\isachardoublequote}{\isasymoplus}\isactrlsub D{\isachardoublequote}\ {\isadigit{2}}{\isadigit{0}}{\isacharparenright}\isanewline
\ \ {\isachardoublequote}xorD\ P\ Q\ \ {\isasymequiv}\ \ {\isacharparenleft}P\ {\isasymand}\isactrlsub D\ {\isasymnot}\isactrlsub D\ Q{\isacharparenright}\ {\isasymor}\isactrlsub D\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ P\ {\isasymand}\isactrlsub D\ Q{\isacharparenright}{\isachardoublequote}\isanewline
\isanewline
\ \ \isanewline
\isamarkupfalse%
\isacommand{axioms}\isanewline
\ \ apl{\isacharunderscore}and{\isacharunderscore}assoc{\isacharcolon}\ \ \ {\isachardoublequote}{\isacharparenleft}{\isacharparenleft}P\ {\isasymand}\isactrlsub D\ Q{\isacharparenright}\ {\isasymand}\isactrlsub D\ R{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}P\ {\isasymand}\isactrlsub D\ {\isacharparenleft}Q\ {\isasymand}\isactrlsub D\ R{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}xor{\isacharunderscore}assoc{\isacharcolon}\ \ \ \ {\isachardoublequote}{\isacharparenleft}{\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ Q{\isacharparenright}\ {\isasymoplus}\isactrlsub D\ R{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ {\isacharparenleft}Q\ {\isasymoplus}\isactrlsub D\ R{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}and{\isacharunderscore}comm{\isacharcolon}\ \ \ \ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymand}\isactrlsub D\ Q{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}Q\ {\isasymand}\isactrlsub D\ P{\isacharparenright}{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}xor{\isacharunderscore}comm{\isacharcolon}\ \ \ \ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ Q{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}Q\ {\isasymoplus}\isactrlsub D\ P{\isacharparenright}{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}and{\isacharunderscore}LC{\isacharcolon}\ \ \ \ \ \ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymand}\isactrlsub D\ {\isacharparenleft}Q\ {\isasymand}\isactrlsub D\ R{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}Q\ {\isasymand}\isactrlsub D\ {\isacharparenleft}P\ {\isasymand}\isactrlsub D\ R{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}xor{\isacharunderscore}LC{\isacharcolon}\ \ \ \ \ \ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ {\isacharparenleft}Q\ {\isasymoplus}\isactrlsub D\ R{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}Q\ {\isasymoplus}\isactrlsub D\ {\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ R{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}and{\isacharunderscore}True{\isacharunderscore}r{\isacharcolon}\ \ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymand}\isactrlsub D\ Ret\ True{\isacharparenright}\ {\isacharequal}\ P{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}and{\isacharunderscore}True{\isacharunderscore}l{\isacharcolon}\ \ \ {\isachardoublequote}{\isacharparenleft}Ret\ True\ {\isasymand}\isactrlsub D\ P{\isacharparenright}\ {\isacharequal}\ P{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}and{\isacharunderscore}absorb{\isacharcolon}\ \ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymand}\isactrlsub D\ P{\isacharparenright}\ {\isacharequal}\ P{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}and{\isacharunderscore}absorb{\isadigit{2}}{\isacharcolon}\ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymand}\isactrlsub D\ {\isacharparenleft}P\ {\isasymand}\isactrlsub D\ Q{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}P\ {\isasymand}\isactrlsub D\ Q{\isacharparenright}{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}and{\isacharunderscore}False{\isacharunderscore}l{\isacharcolon}\ \ {\isachardoublequote}{\isacharparenleft}Ret\ False\ {\isasymand}\isactrlsub D\ P{\isacharparenright}\ {\isacharequal}\ Ret\ False{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}and{\isacharunderscore}False{\isacharunderscore}r{\isacharcolon}\ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymand}\isactrlsub D\ Ret\ False{\isacharparenright}\ {\isacharequal}\ Ret\ False{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}xor{\isacharunderscore}False{\isacharunderscore}r{\isacharcolon}\ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ Ret\ False{\isacharparenright}\ {\isacharequal}\ P{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}xor{\isacharunderscore}False{\isacharunderscore}l{\isacharcolon}\ \ {\isachardoublequote}{\isacharparenleft}Ret\ False\ {\isasymoplus}\isactrlsub D\ P{\isacharparenright}\ {\isacharequal}\ P{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}xor{\isacharunderscore}contr{\isacharcolon}\ \ \ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ P{\isacharparenright}\ {\isacharequal}\ Ret\ False{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}xor{\isacharunderscore}contr{\isadigit{2}}{\isacharcolon}\ \ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ {\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ Q{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ Q{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}and{\isacharunderscore}ldist{\isacharcolon}\ \ \ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymand}\isactrlsub D\ {\isacharparenleft}Q\ {\isasymoplus}\isactrlsub D\ R{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isacharparenleft}P\ {\isasymand}\isactrlsub D\ Q{\isacharparenright}\ {\isasymoplus}\isactrlsub D\ {\isacharparenleft}P\ {\isasymand}\isactrlsub D\ R{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}and{\isacharunderscore}rdist{\isacharcolon}\ \ \ \ {\isachardoublequote}{\isacharparenleft}{\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ Q{\isacharparenright}\ {\isasymand}\isactrlsub D\ R{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isacharparenleft}P\ {\isasymand}\isactrlsub D\ R{\isacharparenright}\ {\isasymoplus}\isactrlsub D\ {\isacharparenleft}Q\ {\isasymand}\isactrlsub D\ R{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ %
\isamarkupcmt{Expressing the connectives by conjunction and exclusive or%
}
\isanewline
\ \ apl{\isacharunderscore}imp{\isacharunderscore}xor{\isacharcolon}\ \ \ \ \ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isacharparenleft}P\ {\isasymand}\isactrlsub D\ Q{\isacharparenright}\ {\isasymoplus}\isactrlsub D\ P\ {\isasymoplus}\isactrlsub D\ Ret\ True{\isacharparenright}{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}or{\isacharunderscore}xor{\isacharcolon}\ \ \ \ \ \ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymor}\isactrlsub D\ Q{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ Q\ {\isasymoplus}\isactrlsub D\ {\isacharparenleft}P\ {\isasymand}\isactrlsub D\ Q{\isacharparenright}{\isacharparenright}{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}not{\isacharunderscore}xor{\isacharcolon}\ \ \ \ \ \ {\isachardoublequote}{\isacharparenleft}{\isasymnot}\isactrlsub D\ P{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ Ret\ True{\isacharparenright}{\isachardoublequote}\isanewline
\ \ apl{\isacharunderscore}iff{\isacharunderscore}xor{\isacharcolon}\ \ \ \ \ \ {\isachardoublequote}{\isacharparenleft}P\ {\isasymlongleftrightarrow}\isactrlsub D\ Q{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ Q\ {\isasymoplus}\isactrlsub D\ Ret\ True{\isacharparenright}{\isachardoublequote}\isamarkupfalse%
%
\begin{isamarkuptext}%
\isa{pdl{\isacharunderscore}taut} is the collection of all these rules, so that
  they can be handed over to the simplifier conveniently.
  
  This set of rewrite rules is complete with respect to normalisation
  of propositional tautologies to their normal form 
  \isa{Ret\ True}. Hence, we can prove monadic tautologies 
  in one fell swoop by applying 
  the tactic \isa{{\isacharparenleft}simp\ only{\isacharcolon}\ pdl{\isacharunderscore}taut\ Valid{\isacharunderscore}Ret{\isacharparenright}}.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemmas}\ pdl{\isacharunderscore}taut\ {\isacharequal}\ \ %
\isamarkupcmt{\dots all axioms above%
}
\isanewline
\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemmas}\ mon{\isacharunderscore}prop{\isacharunderscore}reason\ {\isacharequal}\ Abs{\isacharunderscore}Dsef{\isacharunderscore}inverse\ dsef{\isacharunderscore}liftM{\isadigit{2}}\ \isanewline
\ \ Dsef{\isacharunderscore}def\ conjD{\isacharunderscore}def\ disjD{\isacharunderscore}def\ impD{\isacharunderscore}def\ NotD{\isacharunderscore}def\isamarkupfalse%
%
\begin{isamarkuptext}%
A proof showing in what manner the above axioms may be proved.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\ {\isachardoublequote}{\isacharparenleft}P\ {\isasymand}\isactrlsub D\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ P{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ Ret\ False{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ mon{\isacharunderscore}prop{\isacharunderscore}reason{\isacharcomma}\ simp\ only{\isacharcolon}\ liftM{\isadigit{2}}{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}unfold\ Ret{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}rule\ cong{\isacharbrackleft}of\ Abs{\isacharunderscore}Dsef\ Abs{\isacharunderscore}Dsef{\isacharbrackright}{\isacharcomma}\ rule\ refl{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ Abs{\isacharunderscore}Dsef{\isacharunderscore}inverse\ Dsef{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ mon{\isacharunderscore}ctr\ del{\isacharcolon}\ bind{\isacharunderscore}assoc{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ cp{\isacharunderscore}arb\ dsef{\isacharunderscore}cp{\isacharbrackleft}OF\ dsef{\isacharunderscore}Rep{\isacharunderscore}Dsef{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}rule\ dis{\isacharunderscore}left{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}rule\ dsef{\isacharunderscore}dis{\isacharbrackleft}OF\ dsef{\isacharunderscore}Rep{\isacharunderscore}Dsef{\isacharbrackright}{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{done}\isamarkupfalse%
%
\begin{isamarkuptext}%
And another one, following the same scheme, only that the simplifier now
  needs help from the classical reasoner to finish.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\ {\isachardoublequote}{\isacharparenleft}P\ {\isasymoplus}\isactrlsub D\ Q{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}Q\ {\isasymoplus}\isactrlsub D\ P{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ disjD{\isacharunderscore}def\ conjD{\isacharunderscore}def\ NotD{\isacharunderscore}def\ impD{\isacharunderscore}def\ liftM{\isadigit{2}}{\isacharunderscore}def\ xorD{\isacharunderscore}def\ Ret{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ Abs{\isacharunderscore}Dsef{\isacharunderscore}inverse\ Dsef{\isacharunderscore}def\ dsef{\isacharunderscore}seq\ dsef{\isacharunderscore}Rep{\isacharunderscore}Dsef\ mon{\isacharunderscore}ctr\ del{\isacharcolon}\ bind{\isacharunderscore}assoc{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ commute{\isacharunderscore}dsef{\isacharbrackleft}of\ {\isachardoublequote}{\isasymDown}\ Q{\isachardoublequote}\ {\isachardoublequote}{\isasymDown}\ P{\isachardoublequote}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ dsef{\isacharunderscore}cp\ cp{\isacharunderscore}arb{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}subgoal{\isacharunderscore}tac\ {\isachardoublequote}{\isasymforall}x\ y{\isachardot}\ {\isacharparenleft}x\ {\isasymand}\ {\isasymnot}\ y\ {\isasymor}\ {\isasymnot}\ x\ {\isasymand}\ y{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}y\ {\isasymand}\ {\isasymnot}\ x\ {\isasymor}\ {\isasymnot}\ y\ {\isasymand}\ x{\isacharparenright}{\isachardoublequote}{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{by}\ blast\isamarkupfalse%
%
\isamarkupsubsection{Proof Rules%
}
\isamarkuptrue%
%
\begin{isamarkuptext}%
Proof rules, which can all be proved to be correct, since we have
  the semantics built into the logic (i.e. we can access it within HOL).
  Some proofs however simply employ the above tautology reasoner.
  \label{isa:proof-rules}%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{theorem}\ pdl{\isacharunderscore}excluded{\isacharunderscore}middle{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymor}\isactrlsub D\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ P{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ pdl{\isacharunderscore}taut{\isacharparenright}\isanewline
\isanewline
\isanewline
\isamarkupfalse%
\isacommand{theorem}\ pdl{\isacharunderscore}mp{\isacharcolon}\ {\isachardoublequote}{\isasymlbrakk}{\isasymturnstile}\ P\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isacharsemicolon}\ {\isasymturnstile}\ P{\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ Q{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{by}{\isacharparenleft}simp\ add{\isacharcolon}\ Valid{\isacharunderscore}simp\ impD{\isacharunderscore}def\ liftM{\isadigit{2}}{\isacharunderscore}def\ Rep{\isacharunderscore}Dsef{\isacharunderscore}inverse{\isacharparenright}\isamarkupfalse%
%
\begin{isamarkuptext}%
Disjunction introduction%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{theorem}\ pdl{\isacharunderscore}disjI{\isadigit{1}}{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymLongrightarrow}\ {\isasymturnstile}\ {\isacharparenleft}P\ {\isasymor}\isactrlsub D\ Q{\isacharparenright}{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ {\isachardoublequote}{\isasymturnstile}\ P{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{hence}\ pt{\isacharcolon}\ {\isachardoublequote}{\isasymDown}\ P\ {\isacharequal}\ ret\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ Valid{\isacharunderscore}simp{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ {\isacharparenleft}P\ {\isasymor}\isactrlsub D\ Q{\isacharparenright}\ {\isacharequal}\ ret\ True{\isachardoublequote}\ \isanewline
\ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ {\isacharparenleft}{\isasymUp}\ {\isacharparenleft}liftM{\isadigit{2}}\ op\ {\isasymor}\ {\isacharparenleft}{\isasymDown}\ P{\isacharparenright}\ {\isacharparenleft}{\isasymDown}\ Q{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ ret\ True{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \ \ \ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ {\isacharparenleft}{\isasymUp}\ {\isacharparenleft}do\ {\isacharbraceleft}x{\isasymleftarrow}{\isasymDown}\ Q{\isacharsemicolon}\ ret\ True{\isacharbraceright}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ ret\ True{\isachardoublequote}\isanewline
\ \ \ \ \ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \ \ \ \ \ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ {\isacharparenleft}{\isasymUp}\ {\isacharparenleft}do\ {\isacharbraceleft}x{\isasymleftarrow}{\isasymDown}\ Q{\isacharsemicolon}\ ret\ True{\isacharbraceright}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ do\ {\isacharbraceleft}x{\isasymleftarrow}{\isasymDown}\ Q{\isacharsemicolon}\ ret\ True{\isacharbraceright}{\isachardoublequote}\isanewline
\ \ \ \ \ \ \ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Abs{\isacharunderscore}Dsef{\isacharunderscore}inverse\ Dsef{\isacharunderscore}def\ weak{\isacharunderscore}dsef{\isacharunderscore}seq{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ do\ {\isacharbraceleft}{\isasymDown}\ Q{\isacharsemicolon}\ ret\ True{\isacharbraceright}{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}seq{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ ret\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ dis{\isacharunderscore}Rep{\isacharunderscore}Dsef\ dis{\isacharunderscore}left{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isamarkupfalse%
\isacommand{finally}\ \isamarkupfalse%
\isacommand{show}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{{\isachardot}}\isanewline
\ \ \ \ \ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\ \ \ \ \ \ \isamarkupfalse%
\isacommand{with}\ pt\ \isamarkupfalse%
\isacommand{show}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ liftM{\isadigit{2}}{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{thus}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ disjD{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\ \ \isamarkupfalse%
\isacommand{thus}\ {\isachardoublequote}{\isasymturnstile}\ {\isacharparenleft}P\ {\isasymor}\isactrlsub D\ Q{\isacharparenright}{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ Valid{\isacharunderscore}simp{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isamarkupfalse%
%
\begin{isamarkuptext}%
Entirely analogous for this dual rule.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{theorem}\ pdl{\isacharunderscore}disjI{\isadigit{2}}{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ Q\ {\isasymLongrightarrow}\ {\isasymturnstile}\ {\isacharparenleft}P\ {\isasymor}\isactrlsub D\ Q{\isacharparenright}{\isachardoublequote}\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
\isamarkupfalse%
%
\begin{isamarkuptext}%
The following proof proceeds by a standard pattern: First insert the 
  assumptions into some specifically tailored do-term and then 
  reduce this do-term to \isa{ret\ True} with the simplifier.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{theorem}\ pdl{\isacharunderscore}disjE{\isacharcolon}\ {\isachardoublequote}{\isasymlbrakk}\ {\isasymturnstile}\ P\ {\isasymor}\isactrlsub D\ Q{\isacharsemicolon}\ {\isasymturnstile}\ P\ {\isasymlongrightarrow}\isactrlsub D\ R{\isacharsemicolon}\ {\isasymturnstile}\ Q\ {\isasymlongrightarrow}\isactrlsub D\ R{\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ R{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ a{\isadigit{1}}{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymor}\isactrlsub D\ Q{\isachardoublequote}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymlongrightarrow}\isactrlsub D\ R{\isachardoublequote}\ {\isachardoublequote}{\isasymturnstile}\ Q\ {\isasymlongrightarrow}\isactrlsub D\ R{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{note}\ copy\ {\isacharequal}\ dsef{\isacharunderscore}cp{\isacharbrackleft}OF\ dsef{\isacharunderscore}Rep{\isacharunderscore}Dsef{\isacharbrackright}\isanewline
\ \ \isamarkupfalse%
\isacommand{note}\ dsc\ \ {\isacharequal}\ dsef{\isacharunderscore}dis{\isacharbrackleft}OF\ dsef{\isacharunderscore}Rep{\isacharunderscore}Dsef{\isacharbrackright}\isanewline
\ \ %
\isamarkupcmt{1st part: blow up program \isa{{\isasymDown}\ R} to some giant term:%
}
\isanewline
\ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ R\ {\isacharequal}\ do\ {\isacharbraceleft}u{\isasymleftarrow}ret\ True{\isacharsemicolon}\ v{\isasymleftarrow}ret\ True{\isacharsemicolon}\ w{\isasymleftarrow}ret\ True{\isacharsemicolon}\ r{\isasymleftarrow}{\isasymDown}\ R{\isacharsemicolon}\ ret{\isacharparenleft}u{\isasymlongrightarrow}v{\isasymlongrightarrow}w{\isasymlongrightarrow}r{\isacharparenright}{\isacharbraceright}{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{by}\ simp\isanewline
\ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{from}\ a{\isadigit{1}}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ do\ {\isacharbraceleft}u{\isasymleftarrow}{\isacharparenleft}{\isasymDown}\ {\isacharparenleft}P\ {\isasymor}\isactrlsub D\ Q{\isacharparenright}{\isacharparenright}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v{\isasymleftarrow}{\isacharparenleft}{\isasymDown}\ {\isacharparenleft}P\ {\isasymlongrightarrow}\isactrlsub D\ R{\isacharparenright}{\isacharparenright}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ w{\isasymleftarrow}{\isacharparenleft}{\isasymDown}\ {\isacharparenleft}Q\ {\isasymlongrightarrow}\isactrlsub D\ R{\isacharparenright}{\isacharparenright}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ r{\isasymleftarrow}{\isasymDown}\ R{\isacharsemicolon}\ ret\ {\isacharparenleft}u{\isasymlongrightarrow}v{\isasymlongrightarrow}w{\isasymlongrightarrow}r{\isacharparenright}{\isacharbraceright}{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Valid{\isacharunderscore}simp{\isacharparenright}\isanewline
\ \ %
\isamarkupcmt{2nd part: reduce this giant program to \isa{ret\ True} exploiting
        properties of dsef programs%
}
\isanewline
\ \ \isamarkupfalse%
\isacommand{also}\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymdots}\ {\isacharequal}\ ret\ True{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ mon{\isacharunderscore}prop{\isacharunderscore}reason\ liftM{\isadigit{2}}{\isacharunderscore}def\ dsef{\isacharunderscore}Rep{\isacharunderscore}Dsef\ dsef{\isacharunderscore}seq\ mon{\isacharunderscore}ctr\ del{\isacharcolon}\ bind{\isacharunderscore}assoc{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ commute{\isacharunderscore}dsef{\isacharbrackleft}of\ {\isachardoublequote}{\isasymDown}\ Q{\isachardoublequote}\ {\isachardoublequote}{\isasymDown}\ P{\isachardoublequote}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ commute{\isacharunderscore}dsef{\isacharbrackleft}of\ {\isachardoublequote}{\isasymDown}\ R{\isachardoublequote}\ {\isachardoublequote}{\isasymDown}\ Q{\isachardoublequote}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ dsef{\isacharunderscore}cp{\isacharbrackleft}OF\ dsef{\isacharunderscore}Rep{\isacharunderscore}Dsef{\isacharbrackright}\ cp{\isacharunderscore}arb\ del{\isacharcolon}\ bind{\isacharunderscore}assoc{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}simp\ add{\isacharcolon}\ dsef{\isacharunderscore}dis{\isacharbrackleft}OF\ dsef{\isacharunderscore}Rep{\isacharunderscore}Dsef{\isacharbrackright}\ dis{\isacharunderscore}left{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{done}\isanewline
\ \ \isamarkupfalse%
\isacommand{finally}\ \isamarkupfalse%
\isacommand{show}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ Valid{\isacharunderscore}simp{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isanewline
\ \ \ \ \isanewline
\isanewline
\isamarkupfalse%
\isacommand{theorem}\ pdl{\isacharunderscore}conjI{\isacharcolon}\ {\isachardoublequote}{\isasymlbrakk}\ {\isasymturnstile}\ P{\isacharsemicolon}\ {\isasymturnstile}\ Q\ {\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ P\ {\isasymand}\isactrlsub D\ Q{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ a{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P{\isachardoublequote}\ {\isachardoublequote}{\isasymturnstile}\ Q{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{from}\ a\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ P\ {\isacharequal}\ ret\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Valid{\isacharunderscore}simp{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{moreover}\isanewline
\ \ \isamarkupfalse%
\isacommand{from}\ a\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ Q\ {\isacharequal}\ ret\ True{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Valid{\isacharunderscore}simp{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{ultimately}\ \isanewline
\ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymDown}\ {\isacharparenleft}P\ {\isasymand}\isactrlsub D\ Q{\isacharparenright}\ {\isacharequal}\ ret\ True{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ mon{\isacharunderscore}prop{\isacharunderscore}reason\ liftM{\isadigit{2}}{\isacharunderscore}def{\isacharparenright}\ \isanewline
\ \ \isamarkupfalse%
\isacommand{thus}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ Valid{\isacharunderscore}simp{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isamarkupfalse%
%
\isamarkupsubsubsection{Derived rules of inference%
}
\isamarkuptrue%
\isacommand{theorem}\ pdl{\isacharunderscore}FalseE{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ Ret\ False\ {\isasymLongrightarrow}\ {\isasymturnstile}\ R{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ {\isachardoublequote}{\isasymturnstile}\ Ret\ False{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{hence}\ {\isachardoublequote}False{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ iffD{\isadigit{1}}{\isacharbrackleft}OF\ Valid{\isacharunderscore}Ret{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{thus}\ {\isachardoublequote}{\isasymturnstile}\ R{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ FalseE{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isanewline
\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}notE{\isacharcolon}\ {\isachardoublequote}{\isasymlbrakk}\ {\isasymturnstile}\ P{\isacharsemicolon}\ {\isasymturnstile}\ {\isasymnot}\isactrlsub D\ P\ {\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ R{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharparenleft}unfold\ NotD{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ p{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P{\isachardoublequote}\ \isakeyword{and}\ np{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymlongrightarrow}\isactrlsub D\ Ret\ False{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{from}\ np\ p\ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymturnstile}\ Ret\ False{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ pdl{\isacharunderscore}mp{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{thus}\ {\isachardoublequote}{\isasymturnstile}\ R{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ pdl{\isacharunderscore}FalseE{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isanewline
\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}conjE{\isacharcolon}\ {\isachardoublequote}{\isasymlbrakk}\ {\isasymturnstile}\ P\ {\isasymand}\isactrlsub D\ Q{\isacharsemicolon}\ {\isasymlbrakk}{\isasymturnstile}\ P{\isacharsemicolon}\ {\isasymturnstile}\ Q{\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ R{\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ R{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ a{\isadigit{1}}{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymand}\isactrlsub D\ Q{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ a{\isadigit{2}}{\isacharcolon}\ {\isachardoublequote}{\isasymlbrakk}{\isasymturnstile}\ P{\isacharsemicolon}\ {\isasymturnstile}\ Q{\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ R{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymturnstile}\ P{\isachardoublequote}\ \isanewline
\ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharparenleft}rule\ pdl{\isacharunderscore}mp{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{show}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymand}\isactrlsub D\ Q\ {\isasymlongrightarrow}\isactrlsub D\ P{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ pdl{\isacharunderscore}taut{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\ \ \isamarkupfalse%
\isacommand{moreover}\isanewline
\ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymturnstile}\ Q{\isachardoublequote}\ \isanewline
\ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharparenleft}rule\ pdl{\isacharunderscore}mp{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{show}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymand}\isactrlsub D\ Q\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ pdl{\isacharunderscore}taut{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\ \ \isamarkupfalse%
\isacommand{moreover}\ \isamarkupfalse%
\isacommand{note}\ a{\isadigit{1}}\ a{\isadigit{2}}\isanewline
\ \ \isamarkupfalse%
\isacommand{ultimately}\ \isanewline
\ \ \isamarkupfalse%
\isacommand{show}\ {\isachardoublequote}{\isasymturnstile}\ R{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rules{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isamarkupfalse%
%
\begin{isamarkuptext}%
Some further typical rules.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\ pdl{\isacharunderscore}notI{\isacharcolon}\ {\isachardoublequote}{\isasymlbrakk}\ {\isasymturnstile}\ P{\isacharsemicolon}\ {\isasymturnstile}\ Ret\ False{\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ {\isasymnot}\isactrlsub D\ P{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{by}{\isacharparenleft}rule\ pdl{\isacharunderscore}FalseE{\isacharparenright}\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}conjunct{\isadigit{1}}{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymand}\isactrlsub D\ Q\ {\isasymLongrightarrow}\ {\isasymturnstile}\ P{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymand}\isactrlsub D\ Q{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{thus}\ {\isachardoublequote}{\isasymturnstile}\ P{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharparenleft}rule\ pdl{\isacharunderscore}conjE{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{assume}\ {\isachardoublequote}{\isasymturnstile}\ P{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{thus}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{{\isachardot}}\isanewline
\ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\isamarkupfalse%
\isacommand{qed}\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}conjunct{\isadigit{2}}{\isacharcolon}\ \isakeyword{assumes}\ pq{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymand}\isactrlsub D\ Q{\isachardoublequote}\ \isakeyword{shows}\ {\isachardoublequote}{\isasymturnstile}\ Q{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \isamarkupfalse%
\isacommand{from}\ pq\ \isamarkupfalse%
\isacommand{show}\ {\isachardoublequote}{\isasymturnstile}\ Q{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{proof}\ {\isacharparenleft}rule\ pdl{\isacharunderscore}conjE{\isacharparenright}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{assume}\ {\isachardoublequote}{\isasymturnstile}\ Q{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{thus}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{{\isachardot}}\isanewline
\ \ \isamarkupfalse%
\isacommand{qed}\isanewline
\isamarkupfalse%
\isacommand{qed}\isanewline
\ \ \ \ \isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}iffI{\isacharcolon}\ {\isachardoublequote}{\isasymlbrakk}{\isasymturnstile}\ P\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isacharsemicolon}\ {\isasymturnstile}\ Q\ {\isasymlongrightarrow}\isactrlsub D\ P{\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ P\ {\isasymlongleftrightarrow}\isactrlsub D\ Q{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharparenleft}unfold\ iffD{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ a{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isachardoublequote}\ \isakeyword{and}\ b{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ Q\ {\isasymlongrightarrow}\isactrlsub D\ P{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{show}\ {\isachardoublequote}{\isasymturnstile}\ {\isacharparenleft}P\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isacharparenright}\ {\isasymand}\isactrlsub D\ {\isacharparenleft}Q\ {\isasymlongrightarrow}\isactrlsub D\ P{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ pdl{\isacharunderscore}conjI{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}iffE{\isacharcolon}\ {\isachardoublequote}{\isasymlbrakk}{\isasymturnstile}\ P\ {\isasymlongleftrightarrow}\isactrlsub D\ Q{\isacharsemicolon}\ {\isasymlbrakk}\ {\isasymturnstile}\ P\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isacharsemicolon}\ {\isasymturnstile}\ Q\ {\isasymlongrightarrow}\isactrlsub D\ P\ {\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ R{\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ R{\isachardoublequote}\isanewline
\ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}unfold\ iffD{\isacharunderscore}def{\isacharparenright}\ \isanewline
\ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}erule\ pdl{\isacharunderscore}conjE{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{by}\ blast\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}sym{\isacharcolon}\ {\isachardoublequote}{\isacharparenleft}{\isasymturnstile}\ P\ {\isasymlongleftrightarrow}\isactrlsub D\ Q{\isacharparenright}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\isasymturnstile}\ Q\ {\isasymlongleftrightarrow}\isactrlsub D\ P{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{apply}{\isacharparenleft}erule\ pdl{\isacharunderscore}iffE{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{by}{\isacharparenleft}rule\ pdl{\isacharunderscore}iffI{\isacharparenright}\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}iffD{\isadigit{1}}{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymlongleftrightarrow}\isactrlsub D\ Q\ {\isasymLongrightarrow}\ {\isasymturnstile}\ P\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{by}{\isacharparenleft}erule\ pdl{\isacharunderscore}iffE{\isacharparenright}\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}iffD{\isadigit{2}}{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymlongleftrightarrow}\isactrlsub D\ Q\ {\isasymLongrightarrow}\ {\isasymturnstile}\ Q\ {\isasymlongrightarrow}\isactrlsub D\ P{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}erule\ pdl{\isacharunderscore}iffE{\isacharparenright}\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}conjI{\isacharunderscore}lifted{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isachardoublequote}\ \isakeyword{and}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymlongrightarrow}\isactrlsub D\ R{\isachardoublequote}\ \isakeyword{shows}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymlongrightarrow}\isactrlsub D\ Q\ {\isasymand}\isactrlsub D\ R{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymturnstile}\ {\isacharparenleft}P\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isacharparenright}\ {\isasymlongrightarrow}\isactrlsub D\ {\isacharparenleft}P\ {\isasymlongrightarrow}\isactrlsub D\ R{\isacharparenright}\ {\isasymlongrightarrow}\isactrlsub D\ {\isacharparenleft}P\ {\isasymlongrightarrow}\isactrlsub D\ Q\ {\isasymand}\isactrlsub D\ R{\isacharparenright}{\isachardoublequote}\ \isanewline
\ \ \ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ \ pdl{\isacharunderscore}taut{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{thus}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ pdl{\isacharunderscore}mp{\isacharbrackleft}THEN\ pdl{\isacharunderscore}mp{\isacharbrackright}{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}eq{\isacharunderscore}iff{\isacharcolon}\ {\isachardoublequote}{\isasymlbrakk}\ P\ {\isacharequal}\ Q\ {\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ P\ {\isasymlongleftrightarrow}\isactrlsub D\ Q{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ pdl{\isacharunderscore}taut\ Valid{\isacharunderscore}Ret{\isacharparenright}\isanewline
\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}iff{\isacharunderscore}sym{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymlongleftrightarrow}\isactrlsub D\ Q\ {\isasymLongrightarrow}\ {\isasymturnstile}\ Q\ {\isasymlongleftrightarrow}\isactrlsub D\ P{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ pdl{\isacharunderscore}taut\ Valid{\isacharunderscore}Ret{\isacharparenright}\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}imp{\isacharunderscore}wk{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymLongrightarrow}\ {\isasymturnstile}\ Q\ {\isasymlongrightarrow}\isactrlsub D\ P{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ {\isachardoublequote}{\isasymturnstile}\ P{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymturnstile}\ P\ {\isasymlongrightarrow}\isactrlsub D\ Q\ {\isasymlongrightarrow}\isactrlsub D\ P{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ pdl{\isacharunderscore}taut{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{thus}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ pdl{\isacharunderscore}mp{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isanewline
\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}False{\isacharunderscore}imp{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ Ret\ False\ {\isasymlongrightarrow}\isactrlsub D\ P{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ add{\isacharcolon}\ pdl{\isacharunderscore}taut{\isacharparenright}\isanewline
\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ pdl{\isacharunderscore}imp{\isacharunderscore}trans{\isacharcolon}\ {\isachardoublequote}{\isasymlbrakk}{\isasymturnstile}\ A\ {\isasymlongrightarrow}\isactrlsub D\ B{\isacharsemicolon}\ {\isasymturnstile}\ B\ {\isasymlongrightarrow}\isactrlsub D\ C{\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymturnstile}\ A\ {\isasymlongrightarrow}\isactrlsub D\ C{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{proof}\ {\isacharminus}\isanewline
\ \ \isamarkupfalse%
\isacommand{assume}\ a{\isadigit{1}}{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ A\ {\isasymlongrightarrow}\isactrlsub D\ B{\isachardoublequote}\ \isakeyword{and}\ a{\isadigit{2}}{\isacharcolon}\ {\isachardoublequote}{\isasymturnstile}\ B\ {\isasymlongrightarrow}\isactrlsub D\ C{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{have}\ {\isachardoublequote}{\isasymturnstile}\ {\isacharparenleft}A\ {\isasymlongrightarrow}\isactrlsub D\ B{\isacharparenright}\ {\isasymlongrightarrow}\isactrlsub D\ {\isacharparenleft}B\ {\isasymlongrightarrow}\isactrlsub D\ C{\isacharparenright}\ {\isasymlongrightarrow}\isactrlsub D\ A\ {\isasymlongrightarrow}\isactrlsub D\ C{\isachardoublequote}\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ pdl{\isacharunderscore}taut\ Valid{\isacharunderscore}Ret{\isacharparenright}\isanewline
\ \ \isamarkupfalse%
\isacommand{from}\ this\ a{\isadigit{1}}\ a{\isadigit{2}}\ \isamarkupfalse%
\isacommand{show}\ {\isacharquery}thesis\ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}rule\ pdl{\isacharunderscore}mp{\isacharbrackleft}THEN\ pdl{\isacharunderscore}mp{\isacharbrackright}{\isacharparenright}\isanewline
\isamarkupfalse%
\isacommand{qed}\isamarkupfalse%
%
\begin{isamarkuptext}%
Some applications of the enhanced simplifier, which is now
         capable of proving prop. tautologies immediately.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\ {\isachardoublequote}{\isasymturnstile}\ A\ {\isasymlongrightarrow}\isactrlsub D\ B\ {\isasymlongrightarrow}\isactrlsub D\ A{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ pdl{\isacharunderscore}taut\ Valid{\isacharunderscore}Ret{\isacharparenright}\isanewline
\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ {\isachardoublequote}{\isasymturnstile}\ {\isacharparenleft}P\ {\isasymand}\isactrlsub D\ Q\ {\isasymlongrightarrow}\isactrlsub D\ R{\isacharparenright}\ {\isasymlongleftrightarrow}\isactrlsub D\ {\isacharparenleft}P\ {\isasymlongrightarrow}\isactrlsub D\ Q\ {\isasymlongrightarrow}\isactrlsub D\ R{\isacharparenright}{\isachardoublequote}\isanewline
\isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ pdl{\isacharunderscore}taut\ Valid{\isacharunderscore}Ret{\isacharparenright}\isanewline
\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ {\isachardoublequote}{\isasymturnstile}\ {\isacharparenleft}P\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isacharparenright}\ {\isasymor}\isactrlsub D\ {\isacharparenleft}Q\ {\isasymlongrightarrow}\isactrlsub D\ P{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ pdl{\isacharunderscore}taut\ Valid{\isacharunderscore}Ret{\isacharparenright}\isanewline
\isanewline
\isanewline
\isamarkupfalse%
\isacommand{lemma}\ {\isachardoublequote}{\isasymturnstile}\ {\isacharparenleft}P\ {\isasymlongrightarrow}\isactrlsub D\ Q{\isacharparenright}\ {\isasymand}\isactrlsub D\ {\isacharparenleft}{\isasymnot}\isactrlsub D\ P\ {\isasymlongrightarrow}\isactrlsub D\ R{\isacharparenright}\ {\isasymlongleftrightarrow}\isactrlsub D\ {\isacharparenleft}P\ {\isasymand}\isactrlsub D\ Q\ {\isasymor}\isactrlsub D\ {\isasymnot}\isactrlsub D\ P\ {\isasymand}\isactrlsub D\ R{\isacharparenright}{\isachardoublequote}\isanewline
\ \ \isamarkupfalse%
\isacommand{by}\ {\isacharparenleft}simp\ only{\isacharcolon}\ pdl{\isacharunderscore}taut\ Valid{\isacharunderscore}Ret{\isacharparenright}\isanewline
\isanewline
\isamarkupfalse%
\isacommand{end}\isanewline
\isamarkupfalse%
\end{isabellebody}%
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "root"
%%% End:
